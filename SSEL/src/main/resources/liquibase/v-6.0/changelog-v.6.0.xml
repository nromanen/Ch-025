<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

	<changeSet id="2014-12-11-create-table-test_statistic"
		author="Vitalik">
		<comment>Create table test_statistic</comment>
		<createTable tableName="test_statistic">
			<column name="id" autoIncrement="true" type="int">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="id_test" type="int">
				<constraints nullable="false" />
			</column>
			<column name="id_user" type="int">
				<constraints nullable="false" />
			</column>
			<column name="id_group" type="int">
			</column>
			<column name="id_question" type="int">
				<constraints nullable="false" />
			</column>
			<column name="user_result" type="float">
			</column>
			<column name="max_result" type="int">
			</column>
			<column name="user_answers" type="tinyblob">
			</column>
		</createTable>
	</changeSet>

	<changeSet id="2014-12-11-foreign-key-table-test_statistic-1"
		author="Vitalik">
		<comment>Create foreign key test_statistic</comment>
		<sql>
			ALTER TABLE `test_statistic` ADD
			CONSTRAINT
			fk_test_statistic_tests FOREIGN KEY (id_test)
			REFERENCES ssel.tests
			(id_test) ON DELETE CASCADE ON UPDATE CASCADE;

			ALTER TABLE
			`test_statistic` ADD
			CONSTRAINT fk_test_statistic_user FOREIGN
			KEY
			(id_user)
			REFERENCES ssel.user (id) ON DELETE CASCADE ON UPDATE
			CASCADE;

			ALTER TABLE `test_statistic` ADD
			CONSTRAINT
			fk_test_statistic_group FOREIGN
			KEY (id_group)
			REFERENCES ssel.groups
			(id) ON DELETE CASCADE ON UPDATE
			CASCADE;

			ALTER TABLE `test_statistic`
			ADD
			CONSTRAINT fk_test_statistic_question
			FOREIGN KEY (id_question)
			REFERENCES ssel.questions (id) ON DELETE
			CASCADE ON UPDATE CASCADE;

		</sql>


		<!-- <addForeignKeyConstraint constraintName="fk_test_statistic_user" referencedTableName="user" 
			baseColumnNames="id_user" baseTableName="test_statistic" referencedColumnNames="id" 
			onDelete="SET NULL" onUpdate="CASCADE" /> <addForeignKeyConstraint constraintName="fk_test_statistic_tests" 
			referencedTableName="tests" baseColumnNames="id_test" baseTableName="test_statistic" 
			referencedColumnNames="id_test" onDelete="SET NULL" onUpdate="CASCADE" /> 
			<addForeignKeyConstraint constraintName="fk_test_statistic_group" referencedTableName="groups" 
			baseColumnNames="id_group" baseTableName="test_statistic" referencedColumnNames="id" 
			onDelete="SET NULL" onUpdate="CASCADE" /> -->
	</changeSet>

	<changeSet id="2014-12-13-inserts-in-table-questions" author="Vitalik">
		<comment>Making inserts in table questions</comment>
		<sql>
				INSERT INTO ssel.questions(id, id_Test, questionText, mark, deleted) VALUES
				(2, 1, x'5044393462577767646D567963326C76626A30694D5334774969426C626D4E765A476C755A7A3069565652474C54676949484E305957356B59577876626D5539496E6C6C6379492F50676F386358566C633352706232342B4369416749434138646D46736457552B5558566C63335270623234674D4445384C335A686248566C50676F67494341675047397764476C76626E4D6761584E4462334A795A574E3050534A6D5957787A5A53492B43694167494341674943416750485A686248566C506B6C7559323979636D566A644341774D547776646D46736457552B43694167494341384C32397764476C76626E4D2B436941674943413862334230615739756379427063304E76636E4A6C59335139496D5A6862484E6C496A344B494341674943416749434138646D46736457552B5357356A62334A795A574E304944417950433932595778315A54344B49434167494477766233423061573975637A344B4943416749447876634852706232357A49476C7A51323979636D566A6444306964484A315A53492B43694167494341674943416750485A686248566C506B4E76636E4A6C593351674D444D384C335A686248566C50676F674943416750433976634852706232357A50676F67494341675047397764476C76626E4D6761584E4462334A795A574E3050534A6D5957787A5A53492B43694167494341674943416750485A686248566C506B6C7559323979636D566A644341774E447776646D46736457552B43694167494341384C32397764476C76626E4D2B436A77766358566C633352706232342B43673D3D', 1, False);
				INSERT INTO ssel.questions(id, id_Test, questionText, mark, deleted) VALUES
				(3, 1, x'5044393462577767646D567963326C76626A30694D5334774969426C626D4E765A476C755A7A3069565652474C54676949484E305957356B59577876626D5539496E6C6C6379492F50676F386358566C633352706232342B4369416749434138646D46736457552B5558566C63335270623234674D4449384C335A686248566C50676F67494341675047397764476C76626E4D6761584E4462334A795A574E3050534A6D5957787A5A53492B43694167494341674943416750485A686248566C506B6C7559323979636D566A644341774E547776646D46736457552B43694167494341384C32397764476C76626E4D2B436941674943413862334230615739756379427063304E76636E4A6C59335139496D5A6862484E6C496A344B494341674943416749434138646D46736457552B5357356A62334A795A574E304944413250433932595778315A54344B49434167494477766233423061573975637A344B4943416749447876634852706232357A49476C7A51323979636D566A6444306964484A315A53492B43694167494341674943416750485A686248566C506B4E76636E4A6C593351674D4463384C335A686248566C50676F674943416750433976634852706232357A50676F67494341675047397764476C76626E4D6761584E4462334A795A574E3050534A6D5957787A5A53492B43694167494341674943416750485A686248566C506B6C7559323979636D566A644341774F447776646D46736457552B43694167494341384C32397764476C76626E4D2B436941674943413862334230615739756379427063304E76636E4A6C59335139496E52796457556950676F67494341674943416749447832595778315A54354462334A795A574E304944413550433932595778315A54344B49434167494477766233423061573975637A344B504339786457567A64476C76626A344B', 2, False);
				INSERT INTO ssel.questions(id, id_Test, questionText, mark, deleted) VALUES
				(4, 1, x'5044393462577767646D567963326C76626A30694D5334774969426C626D4E765A476C755A7A3069565652474C54676949484E305957356B59577876626D5539496E6C6C6379492F50676F386358566C633352706232342B4369416749434138646D46736457552B5558566C63335270623234674D444D384C335A686248566C50676F67494341675047397764476C76626E4D6761584E4462334A795A574E3050534A30636E566C496A344B494341674943416749434138646D46736457552B51323979636D566A644341784D447776646D46736457552B43694167494341384C32397764476C76626E4D2B436941674943413862334230615739756379427063304E76636E4A6C59335139496D5A6862484E6C496A344B494341674943416749434138646D46736457552B5357356A62334A795A574E304944457850433932595778315A54344B49434167494477766233423061573975637A344B4943416749447876634852706232357A49476C7A51323979636D566A6444306964484A315A53492B43694167494341674943416750485A686248566C506B4E76636E4A6C593351674D5449384C335A686248566C50676F674943416750433976634852706232357A50676F67494341675047397764476C76626E4D6761584E4462334A795A574E3050534A6D5957787A5A53492B43694167494341674943416750485A686248566C506B6C7559323979636D566A644341784D7A7776646D46736457552B43694167494341384C32397764476C76626E4D2B436A77766358566C633352706232342B43673D3D', 2, False);							
		</sql>
	</changeSet>
	<changeSet id="2014-12-13-inserts-in-table-test_statistic" author="Vitalik">
			<comment>Making inserts in table test_statistic</comment>
			<sql>
			INSERT INTO ssel.test_statistic(id, id_test, id_user, id_group, id_question, user_result, max_result, user_answers) VALUES
			(1, 1, 1, 3, 2, 1, 1, x'ACED0005737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A65787000000004770400000004737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B02000078700000000071007E00047371007E00020000000171007E000478');
			INSERT INTO ssel.test_statistic(id, id_test, id_user, id_group, id_question, user_result, max_result, user_answers) VALUES
			(2, 1, 1, 3, 3, 1, 2, x'ACED0005737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A65787000000005770400000005737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B02000078700000000071007E00047371007E00020000000171007E000571007E000478');
			INSERT INTO ssel.test_statistic(id, id_test, id_user, id_group, id_question, user_result, max_result, user_answers) VALUES
			(3, 1, 1, 3, 4, 0.75, 2, x'ACED0005737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A65787000000004770400000004737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B02000078700000000171007E000471007E00047371007E00020000000078');
			INSERT INTO ssel.test_statistic(id, id_test, id_user, id_group, id_question, user_result, max_result, user_answers) VALUES
			(4, 1, 7, 3, 2, 1, 1, x'ACED0005737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A65787000000004770400000004737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B02000078700000000071007E00047371007E00020000000171007E000478');
			INSERT INTO ssel.test_statistic(id, id_test, id_user, id_group, id_question, user_result, max_result, user_answers) VALUES
			(5, 1, 7, 3, 3, 1, 2, x'ACED0005737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A65787000000005770400000005737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B02000078700000000071007E00047371007E00020000000171007E000571007E000478');
			INSERT INTO ssel.test_statistic(id, id_test, id_user, id_group, id_question, user_result, max_result, user_answers) VALUES
			(6, 1, 7, 3, 4, 0.75, 2, x'ACED0005737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A65787000000004770400000004737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B02000078700000000171007E000471007E00047371007E00020000000078');
			</sql>
	</changeSet>

</databaseChangeLog>